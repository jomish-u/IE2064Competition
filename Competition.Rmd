---
title: "Competition"
author: "Joshua Misiura"
date: "`r Sys.Date()`"
output: pdf_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

```{r echo=FALSE}
#Bring in Libraries
library(readr)
library(readxl)
library(tidyverse)
library(caret)
library(corrplot)
```


```{r}
#load data
training <- read.csv("competition-data.csv") 
test_preds <- read.csv("competition-test-x-values.csv") 
```

```{r}
#cleaning and pred selection
zero_check <- training %>% summarise(across(everything(), ~ sum(. == 0)))
#Predictors which have over 1,000 0's are being automatically removed. We can't assess the signifigance of individual columns, so this is the best route to retain predictors which have unique values
training <- training %>% select(X2:X10, X17:outcome, - X8)
```

```{r}
## Looking to remove highly correlated predictors.

correlation_matrix <- cor(training)

```
```{r}
## Removing X4, X5, X6, X17 
training <- training %>% select(- (X4:X6),- X17)
pairs(training)
```
```{r}
x <- training %>% select(-outcome)
y <- training$outcome
```


```{r}
#KNN
ctrl <- trainControl(method = "cv", number = 10)
knnFit1 <- train(
  x = x,
  y = y,
  preProcess = c("center", "scale"),
  method = "knn",
  trControl = ctrl,
  tuneLength = 15)
## Linear
ctrl = trainControl(method="cv", number = 10)
lmFit <- train( x = x,
                y = (y),
                preProcess = c("center", "scale"),
                method="lm", 
                trControl=ctrl
          )
ctrl = trainControl(method="cv", number = 10)
rfFit <- train( x = x,
                y = y,
                preProcess = c("center", "scale"),
                method="rf", 
                trControl=ctrl
          )

```

